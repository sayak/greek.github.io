<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		
		<title>Greek</title>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.js"></script>
		
		<script>
			var audio;
			var active;
			

			function pause()
			{
				if (audio) 
					audio.pause(); 
				
				if (active) 
				{
					active.pause(); 
					active.currentTime = 0;
				}
			}	
					
			function play(url) 
			{
				pause();
				
				audio = new Audio(url); 
				
				audio.play();	
			}
			
			function play2(id)
			{
				pause();
				
				active = document.getElementById(id);
				
				active.play();
			}
		</script>

		<script>
			
			window.onload = function()
			{
				var req = new XMLHttpRequest();
				
				req.onreadystatechange = function() {
				    if (this.readyState == 4) 
				    {
						var generate = function(ships, offset, count) {						
							for (var i = offset; i < offset+count; i++) 
							{
								var n = i < 9 ? '0' + (i+1) : '' + (i+1);
		
								var parent = document.getElementById("ships");
								
								var image = document.createElement("span");
								image.innerHTML = '<a href="#ring' + n + '"><span class="ring" id="ring' + n + '"><img src="' + ships[i].image + '" onclick="play2(\'' + n + '\');"/><h2>' + (i+1) + '</h2><h3>' + ships[i].greek + '</h3></span></a>'
								parent.appendChild(image);
																	
								var sounds = document.getElementById("sounds");
								
								var audio = document.createElement("audio");
								audio.id = n;
								audio.src = ships[i].sound;
								audio.type = "audio/mpeg"; 
								audio.preload="true";
								
								sounds.appendChild(audio);
							}
							
							
							if (offset + count < ships.length)
								setTimeout( function() { generate(ships, offset + count, count); }, 1000);
							
						}
						
						generate(JSON.parse(this.responseText), 0, 5);
	
				    }
				};
				
				req.open("GET", "ships.json");
				req.send();
			}
		</script>		
		
		<style type="text/css" media="screen">
		
			* 
			{
				margin: 0;
				padding: 0;
				
				-webkit-tap-highlight-color: transparent;
			}
			
			#header
			{
				position: absolute;
				
				width: 100%;
				
				top: 0;
  						  				
  				text-align: center;
 				
 				z-index: -1;
			}
			
			h1
			{
				margin: 20px 20px;
				font: 64px serif;
			}
			
			#subheader 
			{
				margin: 20px 20px;
				font: 22px sans-serif;
				
				white-space: nowrap;
			}
			
			#header div
			{
				font: 18px/22px sans-serif;
				
				white-space: nowrap;
			}
			
			#ships
			{
				width: 100%;
				
				overflow-x: scroll;
				-webkit-overflow-scrolling: touch;
				
				display: inline-block;
				
				background: white;
				
 				margin-top: 40%; 
				
				white-space: nowrap;
				
			}
			
			#ships > span 
			{
				display: inline-block;	
			}
			
			a 
			{
				display: inline-block;

				text-decoration: none;
			}
			
			a span 
			{
				display: inline-block;
 				vertical-align: top;				 
			}
			
			h2 
			{
				
				display: block;
				
				margin-top: 15px;
				padding: 2px;
				
				font: 32px/14px sans-serif;
				
				color: grey;

				text-align: center;
			}
			
			.ring:target h2
			{
				margin-top: 25px;
				font: 44px/14px sans-serif;
			}
			
			h3
			{
				display: block;
				
				margin-top: 15px;
				padding: 2px;
				
				width: 180px;
				font: 14px sans-serif;
				color: grey;
				white-space: pre-wrap;
				text-align: center;
			}
			
			.ring:target h3
			{
				width: 540px;
				margin-top: 25px;
				font: 36px sans-serif;
			}
			
			.ring img
			{
				display: inline-block;
				
				margin: 120px 3px 0px;
				
				width: 180px;
				height: 120px;
				
				background: lightgrey;
				
				border-radius: 180px / 120px;
				
				transition-duration: 0.05s;
			}
			
			.ring:target img 
			{
				margin-top: 0;
				width: 540px;
				height: 360px;
				border-radius: 540px / 360px;
			}	
		</style>
	</head>
	
	<body>
		<div id="header">
			<h1>νεῶν κατάλογος</h1>
			<div id="subheader">KUĢU SARAKSTS  /  CATALOGUE OF SHIPS  /  СПИСОК КОРАБЛЕЙ</div>
			<div>Annas Faniginas izstāde no 2017. gada 7.septembra līdz 3.oktobrim</div>
			<div>Eiropas Savienības Māja, Aspazijas bulv. 28</div>
		</div>
		
		<div id="ships">
<!--
			<a href="#ring1"><span class="ring" id="ring1"><img src="01.jpg" onclick="play2('01.mp3');"/><h2>1</h2><h3>ἔαρ</h3></span></a>
-->
		</div>
		
		<div id="sounds">	
		</div>
	</body>
</html>